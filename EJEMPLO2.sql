CREATE DATABASE EMPLEADOS

USE EMPLEADOS

CREATE TABLE TELEFONO(
CLAVE_TEL INT,
TIPO VARCHAR(50),
CONSTRAINT PK_CT PRIMARY KEY(CLAVE_TEL))

INSERT INTO TELEFONO VALUES(2340,'TELEFONO')
INSERT INTO TELEFONO VALUES(2341,'CELULAR')
INSERT INTO TELEFONO VALUES(2342,'FAX')

CREATE TABLE CALLE(
ID_CALLE INT,
NOM_CALLE VARCHAR(50),
CONSTRAINT PK_IC PRIMARY KEY(ID_CALLE))

INSERT INTO CALLE VALUES(3420,'FRAY SERVANDO')
INSERT INTO CALLE VALUES(3421,'COYUYA')
INSERT INTO CALLE VALUES(3422,'VASCOS DE QUIROGA')
INSERT INTO CALLE VALUES(3423,'REFORMA')
INSERT INTO CALLE VALUES(3424,'GENARO GARCIA')

CREATE TABLE DELEGACION(
ID_DEL INT,
NOM_DEL VARCHAR(50),
CONSTRAINT PK_ID PRIMARY KEY(ID_DEL))

INSERT INTO DELEGACION VALUES(4560,'CUAJIMALPA')
INSERT INTO DELEGACION VALUES(4561,'VENUSTIANO CARRANZA')
INSERT INTO DELEGACION VALUES(4562,'BENITO JUAREZ')
INSERT INTO DELEGACION VALUES(4563,'AZCAPOTZALCO')
INSERT INTO DELEGACION VALUES(4564,'CUAUHTEMOC')

CREATE TABLE COLONIA(
ID_COL INT,
NOM_COL VARCHAR(50),
CONSTRAINT PK_IC2 PRIMARY KEY(ID_COL))

INSERT INTO COLONIA VALUES(5780,'JARDIN BALBUENA')
INSERT INTO COLONIA VALUES(5781,'COYUYA')
INSERT INTO COLONIA VALUES(5782,'REFORMA')
INSERT INTO COLONIA VALUES(5783,'MORELOS')
INSERT INTO COLONIA VALUES(5784,'MOCTEZUMA')


CREATE TABLE PUESTO(
ID_PT INT,
TIPO_PT VARCHAR(50),
CONSTRAINT PK_IP PRIMARY KEY(ID_PT))

INSERT INTO PUESTO VALUES(7810,'ADMINISTRADOR')
INSERT INTO PUESTO VALUES(7811,'RECEPCIONISTA')
INSERT INTO PUESTO VALUES(7812,'MANTENIMIENTO')
INSERT INTO PUESTO VALUES(7813,'DIRECTOR')
INSERT INTO PUESTO VALUES(7814,'ASISTENTE DE DIRECTOR')


CREATE TABLE EMPLEADO(
CLAVE_EMP INT,
NOM_EMP VARCHAR(50),
FECHA_N DATETIME,
FECHA_I DATETIME,
ID_PT1 INT,
ID_CALLE1 INT,
ID_COL1 INT,
ID_DEL1 INT,
NUM_CALLE INT,
CONSTRAINT PK_CE1 PRIMARY KEY(CLAVE_EMP),
CONSTRAINT FK_IP1 FOREIGN KEY(ID_PT1) REFERENCES PUESTO(ID_PT),
CONSTRAINT FK_CA1 FOREIGN KEY(ID_CALLE1) REFERENCES CALLE(ID_CALLE),
CONSTRAINT FK_CO1 FOREIGN KEY(ID_COL1) REFERENCES COLONIA(ID_COL),
CONSTRAINT FK_DE1 FOREIGN KEY(ID_DEL1) REFERENCES DELEGACION(ID_DEL))

INSERT INTO EMPLEADO VALUES(9250,'AUGUSTO','19/04/1996','23/01/2020',7810,3420,5780,4560,785)
INSERT INTO EMPLEADO VALUES(9251,'JORGE','19/03/1995','12/06/2015',7811,3421,5781,4561,345)
INSERT INTO EMPLEADO VALUES(9252,'MERCEDES','29/12/1985','24/07/2021',7812,3422,5782,4562,645)
INSERT INTO EMPLEADO VALUES(9253,'AUREA','30/05/2002','30/09/2030',7813,3423,5783,4563,232)
INSERT INTO EMPLEADO VALUES(9254,'NORMITA','27/10/2001','22/12/2044',7814,3424,5784,4564,434)
INSERT INTO EMPLEADO VALUES(9255,'GUILLERMO','20/11/1950','09/06/2042',7810,3422,5783,4564,323)

SELECT REVERSE(REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((NOM_EMP),'G','9')),'L','1')),'A','#')),'S','2')),'N','&')),'O','3')),'I','='))
FROM EMPLEADO

SELECT DATEADD(YY,10,(DATEADD(DD,-3,DATEADD(MM,-1,FECHA_N))))
FROM EMPLEADO

SELECT DATEADD(YY,-10,(DATEADD(DD,-3,DATEADD(MM,4,FECHA_i))))
FROM EMPLEADO

SELECT UPPER(NOM_EMP)
FROM EMPLEADO


SELECT LOWER(NOM_EMP)
FROM EMPLEADO

SELECT *
FROM EMPLEADO

UPDATE EMPLEADO
SET
NOM_EMP=UPPER(NOM_EMP)

UPDATE EMPLEADO
SET
NOM_EMP=LOWER(NOM_EMP)


UPDATE EMPLEADO
SET
NOM_EMP= REVERSE(REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((NOM_EMP),'G','9')),'L','1')),'A','#')),'S','2')),'N','&')),'O','3')),'I','=')),
FECHA_N=DATEADD(YY,10,(DATEADD(DD,-3,DATEADD(MM,-1,FECHA_N)))),
FECHA_I=DATEADD(YY,-10,(DATEADD(DD,-3,DATEADD(MM,4,FECHA_i))))

UPDATE EMPLEADO
SET
NOM_EMP= REVERSE(REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((REPLACE((NOM_EMP),'9','G')),'1','L')),'#','A')),'2','S')),'&','N')),'3','O')),'=','I')),
FECHA_N=DATEADD(YY,-10,(DATEADD(DD,3,DATEADD(MM,1,FECHA_N)))),
FECHA_I=DATEADD(YY,10,(DATEADD(DD,3,DATEADD(MM,-4,FECHA_i))))

UPDATE EMPLEADO
SET
NOM_EMP=REPLACE(NOM_EMP,'G','U')

CREATE TABLE TEL_EMP(
CLAVE_TEL1 INT,
CLAVE_EMP1 INT,
NUM_TEL INT,
CONSTRAINT FK_CT1 FOREIGN KEY(CLAVE_TEL1) REFERENCES TELEFONO(CLAVE_TEL),
CONSTRAINT FK_CE1 FOREIGN KEY(CLAVE_EMP1) REFERENCES EMPLEADO(CLAVE_EMP))

DROP DATABASE EMPLEADOS




